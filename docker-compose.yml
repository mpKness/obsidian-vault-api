services:
  vault-api:
    build:
      context: .
    container_name: vault-api
    restart: unless-stopped
    ports:
      - "8787:8787"
    environment:
      OBSIDIAN_VAULT_ROOT: /vault
      ADDR: ":8787"
      JWT_ISSUER: "obsidian-vault-api"
      JWT_AUDIENCE: "vault-clients"
      JWT_SECRET: "${JWT_SECRET}"
      # optional: tighten permissions by folder allowlist
      # ALLOW_PREFIXES: "Aarde,World,Sessions"
    volumes:
      - "${VAULT_PATH}:/vault:rw"
    # If your vault has files owned by your user and you hit permission issues,
    # we can run with a matching UID/GID instead of the built-in 10001 user.
